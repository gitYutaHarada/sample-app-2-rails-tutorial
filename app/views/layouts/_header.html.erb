<%
    # current_user
    if session[:user_id]
        if @current_user.nil?
            @current_user = User.find_by(id: session[:user_id])
        end
    elsif cookies.encrypted[:user_id]
        raise
        user = User.find_by(id: cookies.encrypted[:user_id])
        if user && BCrypt::Password.new(user.remember_digest).is_password?(cookies[:remember_token])
            session[:user_id] = user.id
            @current_user = user
        end
    end

%>
<header class="navbar navbar-fixed-top navbar-inverse">
    <div class="container">
    <%= link_to "sample app", root_path, id: "logo" %>
    <nav>
        <ul class="nav navbar-nav navbar-right">
            <li><%= link_to "Home",     root_path   %></li>
            <li><%= link_to "Help",     help_path   %></li>
            <% if !@current_user.nil? %>
                <li><%= link_to "Users", '#' %></li>
                <li class="dropdown">
                    <a href="#" id="account" class="dropdown-toggle">
                        Account <b class="caret"></b>
                    </a>
                    <ul id="dropdown-menu" class="dropdown-menu">
                        <li><%= link_to "Profile", @current_user %></li>
                        <li><%= link_to "Settings", edit_user_path(@current_user) %></li>
                        <li class="divider"></li>
                        <li>
                            <%= link_to "Log out", logout_path,
                                                data: { "turbo-method": :delete } %>
                        </li>
                    </ul>
                </li>
            <% else %>    
                <li><%= link_to "Log in", login_path %></li>
            <% end %>
        </ul>
    </nav>
    </div>
</header>